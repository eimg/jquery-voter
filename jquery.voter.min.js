/**
 * jQuery Voter Plugin
 * Author: Ei Maung (Fairway Web)
 * License: The MIT License (MIT)
 * Usage and Demo: http://fairwayweb.com/jquery-voter-plugin/
 * Version: 0.1, 20 Sep, 2012
 */
(function(a,b,c){function g(b,c){this.element=b;this.options=a.extend({},f,c);this._defaults=f;this._name=d;this.init()}function h(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+c*24*60*60*1e3);var f="; expires="+d.toGMTString()}else var f="";e.cookie=a+"="+b+f+"; path=/"}function i(a){var b=a+"=";var c=e.cookie.split(";");for(var d=0;d<c.length;d++){var f=c[d];while(f.charAt(0)==" ")f=f.substring(1,f.length);if(f.indexOf(b)==0)return f.substring(b.length,f.length)}return null}function j(a){h(a,"",-1)}var d="attachVoter",e=b.document,f={voterClass:"voter",wrapperClass:"voter-wrapper",upVoteClass:"up-vote",upVoteTitle:"Vote Up",voteCountClass:"vote-count",downVoteClass:"down-vote",downVoteTitle:"Vote Down",disabledClass:"disabled",undoTitle:"Click to Undo",votedClass:"voted",plusClass:"good",minusClass:"bad",upVoteChar:"▲",downVoteChar:"▼",useCookie:true,doUpVote:function(){},doDownVote:function(){},undoUpVote:function(){},undoDownVote:function(){}};g.prototype.init=function(){var b=this;var c=this.options;var d=a(this.element);var e=d.data("id");d.wrapInner("<div class='"+c.wrapperClass+"'>");var f=a("<span>",{"class":c.voterClass,"data-state":0,"data-id":e});var g=a("<span>",{"class":c.upVoteClass,title:c.upVoteTitle,"data-id":e}).click(function(){if(f.data("state")==0){a(this).addClass(c.votedClass).attr("title",c.undoTitle);l.addClass(c.disabledClass);k.text(parseInt(k.text())+1);f.data("state",1);if(c.useCookie)h("voted-"+e,"1",30);c.doUpVote(e)}else if(f.data("state")==1){a(this).removeClass(c.votedClass).attr("title",c.upVoteTitle);l.removeClass(c.disabledClass);k.text(parseInt(k.text())-1);f.data("state",0);if(c.useCookie)j("voted-"+e);c.undoUpVote(e)}if(parseInt(k.text())<0){k.attr("class",c.voteCountClass+" "+c.minusClass)}else if(parseInt(k.text())>0){k.attr("class",c.voteCountClass+" "+c.plusClass)}else{k.attr("class",c.voteCountClass)}}).html(c.upVoteChar).appendTo(f);var k=a("<span>",{"class":c.voteCountClass,"data-id":e}).text("0").appendTo(f);var l=a("<span>",{"class":c.downVoteClass,title:c.downVoteTitle,"data-id":e}).click(function(){if(f.data("state")==0){a(this).addClass(c.votedClass).attr("title",c.undoTitle);g.addClass(c.disabledClass);k.text(parseInt(k.text())-1);f.data("state",-1);if(c.useCookie)h("voted-"+e,"-1",30);c.doDownVote(e)}else if(f.data("state")==-1){a(this).removeClass(c.votedClass).attr("title",c.upVoteTitle);g.removeClass(c.disabledClass);k.text(parseInt(k.text())+1);f.data("state",0);if(c.useCookie)j("voted-"+e);c.undoDownVote(e)}if(parseInt(k.text())<0){k.attr("class",c.voteCountClass+" "+c.minusClass)}else if(parseInt(k.text())>0){k.attr("class",c.voteCountClass+" "+c.plusClass)}else{k.attr("class",c.voteCountClass)}}).html(c.downVoteChar).appendTo(f);var m=d.data("value");var n=c.voteCountClass;if(m<0)n=c.voteCountClass+" "+c.minusClass;if(m>0)n=c.voteCountClass+" "+c.plusClass;m=m?m:0;k.text(m).attr("class",n);var o;if(c.useCookie)o=i("voted-"+e);o=o?o:0;f.data("state",o);if(o==1){g.attr("class",c.upVoteClass+" "+c.votedClass).attr("title",c.undoTitle);l.attr("class",c.downVoteClass+" "+c.disabledClass)}else if(o==-1){l.attr("class",c.downVoteClass+" "+c.votedClass).attr("title",c.undoTitle);g.attr("class",c.upVoteClass+" "+c.disabledClass)}a("div",this.element).append(f)};a.fn[d]=function(b){return this.each(function(){if(!a.data(this,"plugin_"+d)){a.data(this,"plugin_"+d,new g(this,b))}})}})(jQuery,window)